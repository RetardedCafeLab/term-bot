<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TERM - –¢–µ—Ä–º–∏–Ω–∞–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: monospace;
            background-color: #1e1e1e;
            color: #f0f0f0;
            margin: 0;
            padding: 20px;
            font-size: 16px;
        }
        
        .terminal {
            background-color: #0c0c0c;
            border-radius: 5px;
            padding: 15px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
            max-width: 600px;
            margin: 20px auto;
        }
        
        .terminal-header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .prompt {
            color: #5bf542;
            font-weight: bold;
        }
        
        .command-line {
            margin-bottom: 10px;
        }
        
        .output {
            color: #cccccc;
            margin-bottom: 15px;
            white-space: pre-wrap;
        }
        
        .button {
            background-color: #333333;
            color: #ffffff;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            margin: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
            font-family: monospace;
        }
        
        .button:hover {
            background-color: #444444;
        }
        
        .button-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
        }
        
        .terminal-input {
            background-color: #0c0c0c;
            border: 1px solid #333;
            color: #5bf542;
            padding: 8px;
            font-family: monospace;
            width: 100%;
            box-sizing: border-box;
            margin-top: 10px;
        }
        
        .subscription-section {
            background-color: #1a1a1a;
            border-radius: 5px;
            padding: 15px;
            margin-top: 20px;
            margin-bottom: 20px;
        }
        
        .section-title {
            font-size: 18px;
            margin-bottom: 10px;
            color: #5bf542;
        }
        
        .channel-option {
            display: flex;
            flex-direction: column;
            background-color: #222;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 10px;
        }
        
        .channel-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .channel-description {
            font-size: 14px;
            color: #aaa;
            margin-bottom: 5px;
        }
        
        .channel-price {
            font-size: 14px;
            color: #5bf542;
        }
        
        .button-row {
            display: flex;
            gap: 5px;
            margin-top: 5px;
        }
        
        .test-mode {
            background-color: #540e0e;
            padding: 5px;
            text-align: center;
            margin-bottom: 10px;
            border-radius: 3px;
            font-size: 14px;
        }
        
        .sending-indicator {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #5bf542;
            color: #000;
            padding: 10px 20px;
            border-radius: 5px;
            font-weight: bold;
            z-index: 1000;
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 0.7; }
            50% { opacity: 1; }
            100% { opacity: 0.7; }
        }
        
        .fallback-message {
            font-size: 14px;
            color: #aaa;
            text-align: center;
        }
        
        .fallback-link {
            color: #5bf542;
            text-decoration: none;
            font-weight: bold;
            margin-left: 5px;
        }
        
        .coming-soon-tag {
            display: inline-block;
            background-color: #5b42f5;
            color: white;
            padding: 3px 8px;
            border-radius: 3px;
            font-size: 12px;
            margin-left: 8px;
            vertical-align: middle;
        }
        
        .channel-coming-soon {
            opacity: 0.6;
            position: relative;
        }
        
        .channel-coming-soon::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.4);
            border-radius: 5px;
            pointer-events: none;
        }
        
        .notify-button {
            background-color: #5b42f5;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 5px;
            cursor: pointer;
            font-family: monospace;
            margin-top: 5px;
        }
        
        .notify-button:hover {
            background-color: #4835c4;
        }
        
        .analytics-event {
            display: none;
        }
    </style>
</head>
<body>
    <div class="terminal">
        <div class="terminal-header">
            <h1>TERM –¢–µ—Ä–º–∏–Ω–∞–ª</h1>
            <p>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Retarded Caf√©</p>
            <div id="test-mode-banner" class="test-mode" style="display: none;">
                –¢–ï–°–¢–û–í–´–ô –†–ï–ñ–ò–ú: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö —Ü–µ–Ω –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–ª–∞—Ç–µ–∂–µ–π
            </div>
        </div>
        
        <div class="command-line">
            <span class="prompt">$</span> whois term
        </div>
        
        <div class="output">
–¢–µ—Ä–º–∏–Ω–∞–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏ Retarded Caf√©.
–ó–¥–µ—Å—å –≤—ã –Ω–∞–π–¥–µ—Ç–µ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã, –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –∫–æ–º–∞–Ω–¥–æ–π.
        </div>
        
        <div class="command-line">
            <span class="prompt">$</span> status
        </div>
        
        <div class="output" id="status-output">
–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–ø–∏—Å–∫–∏...
        </div>
        
        <div class="command-line">
            <span class="prompt">$</span> webapp --debug
        </div>
        
        <div class="output" id="terminal-output">
–ó–∞–≥—Ä—É–∑–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ WebApp...
        </div>
        
        <!-- –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –ª–æ–≥ —Ç–æ–ª—å–∫–æ –≤ —Ç–µ—Å—Ç–æ–≤–æ–º —Ä–µ–∂–∏–º–µ -->
        <div id="log-section" style="display: none;">
            <div class="command-line">
                <span class="prompt">$</span> log
            </div>
            
            <div class="output" id="log-output">
–ñ—É—Ä–Ω–∞–ª —Å–æ–±—ã—Ç–∏–π –ø—É—Å—Ç.
            </div>
        </div>
        
        <div class="subscription-section">
            <div class="section-title">üì± –ü–æ–¥–ø–∏—Å–∫–∏</div>
            
            <div class="channel-option">
                <div class="channel-name">TERM –¢–µ—Ä–º–∏–Ω–∞–ª</div>
                <div class="channel-description">–î–æ—Å—Ç—É–ø –∫ —Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω–æ–º—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é –∏ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–º –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º</div>
                <div class="channel-price" id="term-price">–æ—Ç 1000 Stars / –º–µ—Å—è—Ü</div>
                <div class="button-row">
                    <button class="button" id="subscribe-term-monthly-btn">–ú–µ—Å—è—Ü (<span id="monthly-stars">1000</span>‚≠ê)</button>
                    <button class="button" id="subscribe-term-quarterly-btn">3 –º–µ—Å—è—Ü–∞ (<span id="quarterly-stars">2700</span>‚≠ê)</button>
                    <button class="button" id="subscribe-term-annual-btn">–ì–æ–¥ (<span id="annual-stars">9600</span>‚≠ê)</button>
                </div>
            </div>
            
            <div class="channel-option">
                <div class="channel-name">Disruptor's Journal</div>
                <div class="channel-description">–î–Ω–µ–≤–Ω–∏–∫ —Ü–∏—Ñ—Ä–æ–≤–æ–≥–æ –¥–∏—Å—Å–∏–¥–µ–Ω—Ç–∞</div>
                <div class="channel-price" id="disruptors-price">1024 Stars</div>
                <button class="button" id="subscribe-disruptors-btn">–û—Ñ–æ—Ä–º–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É</button>
            </div>
            
            <div class="channel-option">
                <div class="channel-name">Retarded Caf√© Lab</div>
                <div class="channel-description">–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è</div>
                <div class="channel-price" id="retarded-price">1337 Stars</div>
                <button class="button" id="subscribe-retarded-btn">–û—Ñ–æ—Ä–º–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É</button>
            </div>
            
            <div class="channel-option channel-coming-soon">
                <div class="channel-name">Digital Nomad Protocol <span class="coming-soon-tag">–°–∫–æ—Ä–æ</span></div>
                <div class="channel-description">–¶–∏—Ñ—Ä–æ–≤–æ–π –∫–æ—á–µ–≤–Ω–∏–∫</div>
                <div class="channel-price" id="nomad-price">256 Stars</div>
                <button class="notify-button" id="notify-nomad-btn">–ü–æ–ª—É—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –∑–∞–ø—É—Å–∫–µ</button>
            </div>
        </div>
        
        <div id="fallback-links" style="display: none; margin: 15px 0; padding: 10px; background-color: #333; border-radius: 5px;"></div>
        
        <div class="button-container">
            <button class="button" id="subscribe-btn">–û—Ñ–æ—Ä–º–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É</button>
            <button class="button" id="content-btn">–û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã</button>
            <button class="button" id="status-btn">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å</button>
            <button class="button" id="ask-ai-btn">–°–ø—Ä–æ—Å–∏—Ç—å —É –ò–ò</button>
            <button class="button" id="close-btn">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
        
        <!-- –ù–µ–≤–∏–¥–∏–º—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ -->
        <div class="analytics-event" id="view_subscription_page"></div>
        <div class="analytics-event" id="click_subscribe_button"></div>
        <div class="analytics-event" id="start_payment"></div>
        <div class="analytics-event" id="complete_payment"></div>
        <div class="analytics-event" id="cancel_payment"></div>
        <div class="analytics-event" id="return_after_cancel"></div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp
            const tg = window.Telegram.WebApp;
            tg.expand(); // –†–∞—Å—à–∏—Ä—è–µ–º –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º, –Ω–∞—Ö–æ–¥–∏–º—Å—è –ª–∏ –º—ã –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º (—Ç–µ—Å—Ç–æ–≤–æ–º) –æ–∫—Ä—É–∂–µ–Ω–∏–∏
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–¥–µ–ª–∞–Ω–æ —á–µ—Ä–µ–∑ URL –ø–∞—Ä–∞–º–µ—Ç—Ä –∏–ª–∏ –∑–∞–ø—Ä–æ—Å –∫ API
            const isTestMode = window.location.href.includes('ngrok') || 
                              window.location.hostname === 'localhost' || 
                              window.location.port === '3000' ||
                              window.location.href.includes('local') ||
                              window.location.href.includes('test=true');
            
            // URL API –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –æ–∫—Ä—É–∂–µ–Ω–∏—è
            const API_URL = isTestMode 
                ? 'http://localhost:3001/api/miniapp' 
                : 'https://app.retarded.cafe/api/miniapp';
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ —Ü–µ–Ω—ã –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
            if (isTestMode) {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –±–∞–Ω–Ω–µ—Ä —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞
                document.getElementById('test-mode-banner').style.display = 'block';
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–µ–∫—Ü–∏—é —Å –ª–æ–≥–∞–º–∏
                document.getElementById('log-section').style.display = 'block';
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Ü–µ–Ω—ã –¥–ª—è TERM
                document.getElementById('monthly-stars').textContent = '1';
                document.getElementById('quarterly-stars').textContent = '3';
                document.getElementById('annual-stars').textContent = '10';
                document.getElementById('term-price').textContent = '–æ—Ç 1 Stars / –º–µ—Å—è—Ü (—Ç–µ—Å—Ç)';
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Ü–µ–Ω—ã –¥–ª—è –∫–∞–Ω–∞–ª–æ–≤
                document.getElementById('disruptors-price').textContent = '5 Stars (—Ç–µ—Å—Ç)';
                document.getElementById('retarded-price').textContent = '7 Stars (—Ç–µ—Å—Ç)';
                document.getElementById('nomad-price').textContent = '3 Stars (—Ç–µ—Å—Ç)';
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –¥–µ–±–∞–≥-–ø–∞–Ω–µ–ª—å –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
            const terminalOutput = document.getElementById('terminal-output');
            if (terminalOutput) {
                terminalOutput.innerHTML = 
                    `WebApp Init Data: ${tg.initData ? '–ï—Å—Ç—å ‚úÖ' : '–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç ‚ùå'}<br>` +
                    `User Info: ${tg.initDataUnsafe?.user ? '–ï—Å—Ç—å ‚úÖ' : '–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç ‚ùå'}<br>` +
                    `Test Mode: ${isTestMode ? '–í–∫–ª—é—á–µ–Ω ‚úÖ' : '–í—ã–∫–ª—é—á–µ–Ω ‚ùå'}<br>` +
                    `Platform: ${tg.platform || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}<br>` +
                    `Version: ${tg.version || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}<br>` +
                    `API URL: ${API_URL}<br>`;
            }
            
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
            const userData = tg.initDataUnsafe?.user;
            const statusOutput = document.getElementById('status-output');
            
            // –õ–æ–≥–∏—Ä—É–µ–º –ø—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–æ–¥–ø–∏—Å–∫–∏
            logAnalyticsEvent('view_subscription_page');
            
            if (userData) {
                statusOutput.textContent = `–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ${userData.first_name} ${userData.last_name || ''}\nID: ${userData.id}\n\n–°—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏ –±—É–¥–µ—Ç –ø–æ–∫–∞–∑–∞–Ω –∑–¥–µ—Å—å.`;
                
                // –ó–∞–ø—Ä–æ—Å —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–ø–∏—Å–∫–∏
                fetchSubscriptionStatus();
            } else {
                statusOutput.textContent = '–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.';
            }
            
            /**
             * –õ–æ–≥–∏—Ä—É–µ—Ç —Å–æ–±—ã—Ç–∏–µ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
             * @param {string} eventName - –ù–∞–∑–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è
             * @param {Object} data - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
             */
            function logAnalyticsEvent(eventName, data = {}) {
                // –õ–æ–≥–∏—Ä—É–µ–º —Å–æ–±—ã—Ç–∏–µ –≤ –∫–æ–Ω—Å–æ–ª—å –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä
                const timestamp = new Date().toISOString();
                console.log(`Analytics Event [${timestamp}]: ${eventName}`, data);
                
                // –û—Ç–º–µ—á–∞–µ–º –≤ –∂—É—Ä–Ω–∞–ª–µ
                logAction('analytics', { event: eventName, ...data });
                
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–±—ã—Ç–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
                fetch(`${API_URL}/log-analytics`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        initData: tg.initData,
                        event: eventName,
                        data: data,
                        timestamp: timestamp
                    })
                }).catch(error => {
                    console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏:', error);
                });
            }
            
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–ø–∏—Å–∫–∏
            async function fetchSubscriptionStatus() {
                try {
                    logAction('check_status', { action: 'check subscription status' });
                    
                    const response = await fetch(`${API_URL}/get-subscription-status`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            initData: tg.initData
                        })
                    });
                    
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    
                    const data = await response.json();
                    
                    if (data.success) {
                        const subsInfo = data.subscription;
                        
                        if (data.has_subscription) {
                            statusOutput.textContent = `–ê–∫—Ç–∏–≤–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞: ${subsInfo.tier}\n–î–µ–π—Å—Ç–≤—É–µ—Ç –¥–æ: ${new Date(subsInfo.end_date).toLocaleDateString()}\n–û—Å—Ç–∞–ª–æ—Å—å –¥–Ω–µ–π: ${subsInfo.days_left}`;
                        } else {
                            statusOutput.textContent = '–£ –≤–∞—Å –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ–Ω—é –Ω–∏–∂–µ, —á—Ç–æ–±—ã –æ—Ñ–æ—Ä–º–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É.';
                        }
                    } else {
                        throw new Error(data.error || '–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–¥–ø–∏—Å–∫–µ');
                    }
                } catch (error) {
                    logAction('error', { action: 'check_status', error: error.message });
                    statusOutput.textContent = `–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞: ${error.message}`;
                }
            }
            
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏–π
            function logAction(action, data) {
                // –í –ª—é–±–æ–º —Ä–µ–∂–∏–º–µ –ª–æ–≥–∏—Ä—É–µ–º –≤ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞
                console.log(`Action: ${action}`, data);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º UI —Å –ª–æ–≥–∞–º–∏ —Ç–æ–ª—å–∫–æ –≤ —Ç–µ—Å—Ç–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
                if (isTestMode) {
                    const logOutput = document.getElementById('log-output');
                    if (logOutput) {
                        const timestamp = new Date().toLocaleTimeString();
                        logOutput.innerHTML = `${timestamp}: ${action} ‚Üí ${JSON.stringify(data)}<br>` + logOutput.innerHTML;
                    }
                }
            }
            
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω–≤–æ–π—Å–∞ –≤ TERM
            async function createTermInvoice(tierId) {
                try {
                    // –õ–æ–≥–∏—Ä—É–µ–º –Ω–∞–∂–∞—Ç–∏–µ –Ω–∞ –∫–Ω–æ–ø–∫—É –ø–æ–¥–ø–∏—Å–∫–∏
                    logAnalyticsEvent('click_subscribe_button', { type: 'term', tier: tierId });
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –≤–∏–∑—É–∞–ª—å–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä
                    const indicator = document.createElement('div');
                    indicator.className = 'sending-indicator';
                    indicator.textContent = '–°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞...';
                    document.body.appendChild(indicator);
                    
                    logAction('create_term_invoice', { tierId, test_mode: isTestMode });
                    
                    // –õ–æ–≥–∏—Ä—É–µ–º –Ω–∞—á–∞–ª–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ–ø–ª–∞—Ç—ã
                    logAnalyticsEvent('start_payment', { type: 'term', tier: tierId });
                    
                    // –î–µ–ª–∞–µ–º –∑–∞–ø—Ä–æ—Å –∫ API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Å—ã–ª–∫–∏ –Ω–∞ –∏–Ω–≤–æ–π—Å
                    const response = await fetch(`${API_URL}/create-term-invoice`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            initData: tg.initData,
                            tierId: tierId,
                            test_mode: isTestMode
                        })
                    });
                    
                    // –£–¥–∞–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä
                    document.body.removeChild(indicator);
                    
                    if (!response.ok) {
                        const errorText = await response.text();
                        throw new Error(`–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞: ${response.status} - ${errorText}`);
                    }
                    
                    const data = await response.json();
                    
                    if (data.success && data.invoice_url) {
                        logAction('invoice_created', { 
                            tier_name: data.tier_name, 
                            amount: data.amount, 
                            duration: data.duration 
                        });
                        
                        // –ò—Å–ø–æ–ª—å–∑—É–µ–º WebApp.openInvoice –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –∏–Ω–≤–æ–π—Å–∞ –ø—Ä—è–º–æ –≤ WebApp
                        window.Telegram.WebApp.openInvoice(data.invoice_url, function(status) {
                            if (status === 'paid') {
                                logAction('payment_success', { tierId, status });
                                logAnalyticsEvent('complete_payment', { 
                                    type: 'term', 
                                    tier: tierId, 
                                    amount: data.amount
                                });
                                
                                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç—ã
                                fetchSubscriptionStatus();
                            } else {
                                logAction('payment_cancelled', { tierId, status });
                                logAnalyticsEvent('cancel_payment', { 
                                    type: 'term', 
                                    tier: tierId,
                                    status: status
                                });
                                
                                // –ß–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã –ø—Ä–æ–≤–µ—Ä—è–µ–º, –≤–µ—Ä–Ω—É–ª—Å—è –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫ —Ñ–æ—Ä–º–µ
                                setTimeout(() => {
                                    if (document.visibilityState === 'visible') {
                                        logAnalyticsEvent('return_after_cancel', { 
                                            type: 'term', 
                                            tier: tierId 
                                        });
                                    }
                                }, 3000);
                            }
                        });
                    } else {
                        throw new Error(data.error || '–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –∏–Ω–≤–æ–π—Å');
                    }
                } catch (error) {
                    logAction('error', { action: 'create_term_invoice', tierId, error: error.message });
                    logAnalyticsEvent('payment_error', { 
                        type: 'term', 
                        tier: tierId,
                        error: error.message
                    });
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
                    const errorMsg = document.createElement('div');
                    errorMsg.className = 'error-message';
                    errorMsg.textContent = `–û—à–∏–±–∫–∞: ${error.message}`;
                    errorMsg.style.backgroundColor = '#ff4c4c';
                    errorMsg.style.color = 'white';
                    errorMsg.style.padding = '10px';
                    errorMsg.style.margin = '10px 0';
                    errorMsg.style.borderRadius = '5px';
                    errorMsg.style.textAlign = 'center';
                    
                    // –£–¥–∞–ª—è–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
                    const previousErrors = document.querySelectorAll('.error-message');
                    previousErrors.forEach(el => el.remove());
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –≤–µ—Ä—Ö–Ω—é—é —á–∞—Å—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
                    const terminalHeader = document.querySelector('.terminal-header');
                    terminalHeader.after(errorMsg);
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—É—é —Å—Å—ã–ª–∫—É
                    showFallbackLink('/subscribe');
                    
                    // –£–¥–∞–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
                    setTimeout(() => {
                        errorMsg.remove();
                    }, 5000);
                }
            }
            
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω–≤–æ–π—Å–∞ –¥–ª—è –∫–∞–Ω–∞–ª–∞
            async function createChannelInvoice(channelId) {
                try {
                    // –õ–æ–≥–∏—Ä—É–µ–º –Ω–∞–∂–∞—Ç–∏–µ –Ω–∞ –∫–Ω–æ–ø–∫—É –ø–æ–¥–ø–∏—Å–∫–∏
                    logAnalyticsEvent('click_subscribe_button', { type: 'channel', channel: channelId });
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –≤–∏–∑—É–∞–ª—å–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä
                    const indicator = document.createElement('div');
                    indicator.className = 'sending-indicator';
                    indicator.textContent = '–°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞...';
                    document.body.appendChild(indicator);
                    
                    logAction('create_channel_invoice', { channelId, test_mode: isTestMode });
                    
                    // –õ–æ–≥–∏—Ä—É–µ–º –Ω–∞—á–∞–ª–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ–ø–ª–∞—Ç—ã
                    logAnalyticsEvent('start_payment', { type: 'channel', channel: channelId });
                    
                    // –î–µ–ª–∞–µ–º –∑–∞–ø—Ä–æ—Å –∫ API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Å—ã–ª–∫–∏ –Ω–∞ –∏–Ω–≤–æ–π—Å
                    const response = await fetch(`${API_URL}/create-channel-invoice`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            initData: tg.initData,
                            channelId: channelId,
                            test_mode: isTestMode
                        })
                    });
                    
                    // –£–¥–∞–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä
                    document.body.removeChild(indicator);
                    
                    if (!response.ok) {
                        const errorText = await response.text();
                        throw new Error(`–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞: ${response.status} - ${errorText}`);
                    }
                    
                    const data = await response.json();
                    
                    if (data.success && data.invoice_url) {
                        logAction('invoice_created', { 
                            channel_name: data.channel_name, 
                            amount: data.amount, 
                            duration: data.duration 
                        });
                        
                        // –ò—Å–ø–æ–ª—å–∑—É–µ–º WebApp.openInvoice –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –∏–Ω–≤–æ–π—Å–∞ –ø—Ä—è–º–æ –≤ WebApp
                        window.Telegram.WebApp.openInvoice(data.invoice_url, function(status) {
                            if (status === 'paid') {
                                logAction('payment_success', { channelId, status });
                                logAnalyticsEvent('complete_payment', { 
                                    type: 'channel', 
                                    channel: channelId, 
                                    amount: data.amount
                                });
                                
                                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç—ã
                                fetchSubscriptionStatus();
                            } else {
                                logAction('payment_cancelled', { channelId, status });
                                logAnalyticsEvent('cancel_payment', { 
                                    type: 'channel', 
                                    channel: channelId,
                                    status: status
                                });
                                
                                // –ß–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã –ø—Ä–æ–≤–µ—Ä—è–µ–º, –≤–µ—Ä–Ω—É–ª—Å—è –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫ —Ñ–æ—Ä–º–µ
                                setTimeout(() => {
                                    if (document.visibilityState === 'visible') {
                                        logAnalyticsEvent('return_after_cancel', { 
                                            type: 'channel', 
                                            channel: channelId 
                                        });
                                    }
                                }, 3000);
                            }
                        });
                    } else {
                        throw new Error(data.error || '–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –∏–Ω–≤–æ–π—Å');
                    }
                } catch (error) {
                    logAction('error', { action: 'create_channel_invoice', channelId, error: error.message });
                    logAnalyticsEvent('payment_error', { 
                        type: 'channel',
                        channel: channelId,
                        error: error.message 
                    });
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
                    const errorMsg = document.createElement('div');
                    errorMsg.className = 'error-message';
                    errorMsg.textContent = `–û—à–∏–±–∫–∞: ${error.message}`;
                    errorMsg.style.backgroundColor = '#ff4c4c';
                    errorMsg.style.color = 'white';
                    errorMsg.style.padding = '10px';
                    errorMsg.style.margin = '10px 0';
                    errorMsg.style.borderRadius = '5px';
                    errorMsg.style.textAlign = 'center';
                    
                    // –£–¥–∞–ª—è–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
                    const previousErrors = document.querySelectorAll('.error-message');
                    previousErrors.forEach(el => el.remove());
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –≤–µ—Ä—Ö–Ω—é—é —á–∞—Å—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
                    const terminalHeader = document.querySelector('.terminal-header');
                    terminalHeader.after(errorMsg);
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—É—é —Å—Å—ã–ª–∫—É
                    showFallbackLink('/subscribe');
                    
                    // –£–¥–∞–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
                    setTimeout(() => {
                        errorMsg.remove();
                    }, 5000);
                }
            }
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –∫–Ω–æ–ø–æ–∫ –ø–æ–¥–ø–∏—Å–∫–∏ TERM
            document.getElementById('subscribe-term-monthly-btn').addEventListener('click', function() {
                createTermInvoice('monthly');
            });
            
            document.getElementById('subscribe-term-quarterly-btn').addEventListener('click', function() {
                createTermInvoice('quarterly');
            });
            
            document.getElementById('subscribe-term-annual-btn').addEventListener('click', function() {
                createTermInvoice('annual');
            });
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –∫–Ω–æ–ø–æ–∫ –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ –∫–∞–Ω–∞–ª—ã
            document.getElementById('subscribe-disruptors-btn').addEventListener('click', function() {
                createChannelInvoice('disruptors_journal');
            });
            
            document.getElementById('subscribe-retarded-btn').addEventListener('click', function() {
                createChannelInvoice('retarded_cafe_lab');
            });
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–∞–ø—É—Å–∫–µ Digital Nomad Protocol
            document.getElementById('notify-nomad-btn').addEventListener('click', function() {
                logAnalyticsEvent('notify_request', { channel: 'digital_nomad_protocol' });
                
                try {
                    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –±–æ—Ç—É
                    const data = {
                        action: 'notify_launch',
                        channel: 'digital_nomad_protocol'
                    };
                    logAction('notify_launch', data);
                    tg.sendData(JSON.stringify(data));
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—à–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–µ –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
                    const successMsg = document.createElement('div');
                    successMsg.className = 'success-message';
                    successMsg.textContent = '–í—ã —É—Å–ø–µ—à–Ω–æ –ø–æ–¥–ø–∏—Å–∞–ª–∏—Å—å –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–∞–ø—É—Å–∫–µ Digital Nomad Protocol';
                    successMsg.style.backgroundColor = '#5bf542';
                    successMsg.style.color = 'black';
                    successMsg.style.padding = '10px';
                    successMsg.style.margin = '10px 0';
                    successMsg.style.borderRadius = '5px';
                    successMsg.style.textAlign = 'center';
                    
                    // –£–¥–∞–ª—è–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± —É—Å–ø–µ—Ö–µ
                    const previousMessages = document.querySelectorAll('.success-message');
                    previousMessages.forEach(el => el.remove());
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –≤–µ—Ä—Ö–Ω—é—é —á–∞—Å—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
                    const terminalHeader = document.querySelector('.terminal-header');
                    terminalHeader.after(successMsg);
                    
                    // –£–¥–∞–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
                    setTimeout(() => {
                        successMsg.remove();
                    }, 5000);
                    
                    // –ò–∑–º–µ–Ω—è–µ–º —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏
                    document.getElementById('notify-nomad-btn').textContent = '–í—ã –ø–æ–¥–ø–∏—Å–∞–Ω—ã –Ω–∞ –∑–∞–ø—É—Å–∫';
                    document.getElementById('notify-nomad-btn').disabled = true;
                } catch (error) {
                    logAction('error', { action: 'notify_launch', error: error.message });
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
                    const errorMsg = document.createElement('div');
                    errorMsg.className = 'error-message';
                    errorMsg.textContent = `–û—à–∏–±–∫–∞: ${error.message}`;
                    errorMsg.style.backgroundColor = '#ff4c4c';
                    errorMsg.style.color = 'white';
                    errorMsg.style.padding = '10px';
                    errorMsg.style.margin = '10px 0';
                    errorMsg.style.borderRadius = '5px';
                    errorMsg.style.textAlign = 'center';
                    
                    // –£–¥–∞–ª—è–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
                    const previousErrors = document.querySelectorAll('.error-message');
                    previousErrors.forEach(el => el.remove());
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –≤–µ—Ä—Ö–Ω—é—é —á–∞—Å—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
                    const terminalHeader = document.querySelector('.terminal-header');
                    terminalHeader.after(errorMsg);
                    
                    // –£–¥–∞–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
                    setTimeout(() => {
                        errorMsg.remove();
                    }, 5000);
                }
            });
            
            // –î—Ä—É–≥–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫ (–∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–µ—Ä–µ–¥–∞—á—É –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ bot)
            document.getElementById('subscribe-btn').addEventListener('click', function() {
                logAnalyticsEvent('click_menu_button', { button: 'subscribe' });
                
                const data = {
                    action: 'subscribe'
                };
                logAction('subscribe', data);
                tg.sendData(JSON.stringify(data));
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—É—é —Å—Å—ã–ª–∫—É
                showFallbackLink('/subscribe');
            });
            
            document.getElementById('content-btn').addEventListener('click', function() {
                logAnalyticsEvent('click_menu_button', { button: 'content' });
                
                const data = {
                    action: 'content'
                };
                logAction('content', data);
                tg.sendData(JSON.stringify(data));
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—É—é —Å—Å—ã–ª–∫—É
                showFallbackLink('/content');
            });
            
            document.getElementById('status-btn').addEventListener('click', function() {
                logAnalyticsEvent('click_menu_button', { button: 'status' });
                
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –±–æ—Ç—É
                const data = {
                    action: 'status'
                };
                logAction('status', data);
                tg.sendData(JSON.stringify(data));
                
                // –ê —Ç–∞–∫–∂–µ –æ–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –≤ –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
                fetchSubscriptionStatus();
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—É—é —Å—Å—ã–ª–∫—É
                showFallbackLink('/status');
            });
            
            document.getElementById('ask-ai-btn').addEventListener('click', function() {
                logAnalyticsEvent('click_menu_button', { button: 'ask_ai' });
                
                const data = {
                    action: 'ask_ai'
                };
                logAction('ask_ai', data);
                tg.sendData(JSON.stringify(data));
                
                // –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–π —Å—Å—ã–ª–∫–∏ –Ω–µ—Ç –¥–ª—è —ç—Ç–æ–π –∫–æ–º–∞–Ω–¥—ã
                tg.close();
            });
            
            document.getElementById('close-btn').addEventListener('click', function() {
                logAnalyticsEvent('click_menu_button', { button: 'close' });
                tg.close();
            });
            
            // –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º –≤–∏–¥–∏–º–æ—Å—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
            document.addEventListener('visibilitychange', function() {
                if (document.visibilityState === 'visible') {
                    logAnalyticsEvent('return_to_app');
                } else {
                    logAnalyticsEvent('leave_app');
                }
            });
            
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–π —Å—Å—ã–ª–∫–∏
            function showFallbackLink(command) {
                setTimeout(() => {
                    // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Å–µ –µ—â–µ –≤ –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã,
                    // –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ –ø—Ä—è–º—É—é –∫–æ–º–∞–Ω–¥—É
                    const fallbackDiv = document.getElementById('fallback-links');
                    if (fallbackDiv) {
                        fallbackDiv.innerHTML = `
                            <div class="fallback-message">
                                –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ –æ—Ç–ø—Ä–∞–≤–∏–ª–∏—Å—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä—è–º—É—é –∫–æ–º–∞–Ω–¥—É:
                                <a href="https://t.me/your_bot_username${command}" class="fallback-link">${command}</a>
                            </div>
                        `;
                        fallbackDiv.style.display = 'block';
                    }
                }, 3000);
            }
        });
    </script>
</body>
</html> 